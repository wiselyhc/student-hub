<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Library - S Study Hub</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Cinzel+Decorative:wght@700&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest"></script>

    <style>
        html { scroll-behavior: smooth; }
        .font-logo { font-family: 'Cinzel Decorative', cursive; }
        [x-cloak] { display: none !important; }
        :root { --bg-color: #f3f4f6; --text-color: #1f2937; --text-muted-color: #6b7280; --card-bg-color: #ffffff; --border-color: #e5e7eb; --sidebar-bg-color: #ffffff; --sidebar-border-color: #e5e7eb; --active-icon-bg-color: #e5e7eb; --active-link-color: #1f2937; --active-tab-border-color: #111827; --input-bg-color: #ffffff; --input-border-color: #d1d5db; --focus-ring-color: #111827; }
        .dark { --bg-color: #0f172a; --text-color: #cbd5e1; --text-muted-color: #94a3b8; --card-bg-color: #1e293b; --border-color: #334155; --sidebar-bg-color: #1e293b; --sidebar-border-color: #334155; --active-icon-bg-color: #334155; --active-link-color: #ffffff; --active-tab-border-color: #ffffff; --input-bg-color: #334155; --input-border-color: #475569; --focus-ring-color: #ffffff; }
        .cyber { --bg-color: #0d0c22; --text-color: #a5b4fc; --text-muted-color: #818cf8; --card-bg-color: rgba(30, 41, 59, 0.7); --border-color: #4f46e5; --sidebar-bg-color: #1e293b; --sidebar-border-color: #a855f7; --active-icon-bg-color: #4338ca; --active-link-color: #c7d2fe; --active-tab-border-color: #67e8f9; --input-bg-color: rgba(30, 41, 59, 0.7); --input-border-color: #4f46e5; --focus-ring-color: #67e8f9; }
        .forest { --bg-color: #052e16; --text-color: #a7f3d0; --text-muted-color: #6ee7b7; --card-bg-color: #064e3b; --border-color: #047857; --sidebar-bg-color: #064e3b; --sidebar-border-color: #047857; --active-icon-bg-color: #047857; --active-link-color: #ffffff; --active-tab-border-color: #a7f3d0; --input-bg-color: #064e3b; --input-border-color: #047857; --focus-ring-color: #a7f3d0; }
        .ocean { --bg-color: #0c2444; --text-color: #a5b4fc; --text-muted-color: #818cf8; --card-bg-color: #1e3a8a; --border-color: #1d4ed8; --sidebar-bg-color: #1e3a8a; --sidebar-border-color: #1d4ed8; --active-icon-bg-color: #1d4ed8; --active-link-color: #ffffff; --active-tab-border-color: #a5b4fc; --input-bg-color: #1e3a8a; --input-border-color: #1d4ed8; --focus-ring-color: #a5b4fc; }
        .sunset { --bg-color: #450a0a; --text-color: #fca5a5; --text-muted-color: #f87171; --card-bg-color: #7f1d1d; --border-color: #b91c1c; --sidebar-bg-color: #7f1d1d; --sidebar-border-color: #b91c1c; --active-icon-bg-color: #b91c1c; --active-link-color: #ffffff; --active-tab-border-color: #fca5a5; --input-bg-color: #7f1d1d; --input-border-color: #b91c1c; --focus-ring-color: #fca5a5; }
    </style>
    <script src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>
</head>
<body 
    class="antialiased bg-[var(--bg-color)] text-[var(--text-color)] transition-colors duration-300"
    x-data="{ theme: localStorage.getItem('theme') || 'light', showModal: false, mainOpen: true, openSenior: '' }"
    x-init="$watch('theme', val => localStorage.setItem('theme', val))"
    :class="{ 'dark': theme === 'dark', 'cyber': theme === 'cyber', 'forest': theme === 'forest', 'ocean': theme === 'ocean', 'sunset': theme === 'sunset' }">

    <!-- Library Quick Nav Menu -->
    <div x-data="{ open: false }" class="fixed top-6 left-6 z-50">
        <!-- Circular Menu Button -->
        <button @click="open = !open" 
                class="relative z-10 w-14 h-14 flex items-center justify-center rounded-full bg-[var(--card-bg-color)] text-[var(--text-color)] shadow-lg border border-[var(--border-color)] transition-transform duration-300 ease-in-out hover:scale-110"
                aria-label="Library navigation menu"
                :class="{ 'ring-2 ring-[var(--focus-ring-color)] ring-offset-2 ring-offset-[var(--bg-color)]': open }">
            <i data-lucide="book-marked" class="w-7 h-7"></i>
        </button>
        
        <!-- Dropdown Menu -->
        <div x-show="open"
             @click.outside="open = false"
             x-cloak
             x-transition:enter="transition ease-out duration-100"
             x-transition:enter-start="opacity-0 scale-95"
             x-transition:enter-end="opacity-100 scale-100"
             x-transition:leave="transition ease-in duration-75"
             x-transition:leave-start="opacity-100 scale-100"
             x-transition:leave-end="opacity-0 scale-95"
             class="absolute top-full mt-2 w-56 bg-[var(--card-bg-color)] rounded-xl shadow-2xl border border-[var(--border-color)] overflow-hidden">
            
            <div class="p-2">
                <a href="#s1-folder" @click="open = false; mainOpen = true; openSenior = 's1'; $nextTick(() => document.getElementById('s1-folder').scrollIntoView({ behavior: 'smooth' }))" class="flex items-center space-x-3 px-3 py-2.5 text-sm font-medium text-[var(--text-color)] hover:bg-[var(--active-icon-bg-color)] rounded-lg transition-colors">
                    <i data-lucide="folder" class="w-4 h-4 text-[var(--text-muted-color)]"></i>
                    <span>Senior One</span>
                </a>
                <a href="#s2-folder" @click="open = false; mainOpen = true; openSenior = 's2'; $nextTick(() => document.getElementById('s2-folder').scrollIntoView({ behavior: 'smooth' }))" class="flex items-center space-x-3 px-3 py-2.5 text-sm font-medium text-[var(--text-color)] hover:bg-[var(--active-icon-bg-color)] rounded-lg transition-colors">
                    <i data-lucide="folder" class="w-4 h-4 text-[var(--text-muted-color)]"></i>
                    <span>Senior Two</span>
                </a>
                <a href="#s3-folder" @click="open = false; mainOpen = true; openSenior = 's3'; $nextTick(() => document.getElementById('s3-folder').scrollIntoView({ behavior: 'smooth' }))" class="flex items-center space-x-3 px-3 py-2.5 text-sm font-medium text-[var(--text-color)] hover:bg-[var(--active-icon-bg-color)] rounded-lg transition-colors">
                    <i data-lucide="folder" class="w-4 h-4 text-[var(--text-muted-color)]"></i>
                    <span>Senior Three</span>
                </a>
                <a href="#s4-folder" @click="open = false; mainOpen = true; openSenior = 's4'; $nextTick(() => document.getElementById('s4-folder').scrollIntoView({ behavior: 'smooth' }))" class="flex items-center space-x-3 px-3 py-2.5 text-sm font-medium text-[var(--text-color)] hover:bg-[var(--active-icon-bg-color)] rounded-lg transition-colors">
                    <i data-lucide="folder" class="w-4 h-4 text-[var(--text-muted-color)]"></i>
                    <span>Senior Four</span>
                </a>
            </div>
        </div>
    </div>

    <main class="min-h-screen p-4 sm:p-8">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
            <div class="flex justify-between items-center mb-12">
                <div>
                    <h2 class="text-3xl font-bold text-[var(--text-color)]">My Library</h2>
                    <p class="text-[var(--text-muted-color)] mt-2">All your study materials, organized in one place.</p>
                </div>
                <button @click="showModal = true" id="recommend-button" class="px-5 py-2.5 bg-[var(--card-bg-color)] text-[var(--text-color)] rounded-md hover:opacity-90 transition-colors duration-300 font-semibold flex items-center space-x-2 border border-[var(--border-color)]">
                    <i data-lucide="mail" class="w-5 h-5"></i>
                    <span>Send a Book Recommendation</span>
                </button>
            </div>

            <!-- Web Search Bar -->
            <form id="web-search-form" class="mb-12 max-w-3xl mx-auto" x-data>
                
            <!-- Local Search Bar -->
            <div id="local-search-bar" class="mb-12 max-w-3xl mx-auto">
                <div class="relative flex items-center mt-8">
                    <input type="text" id="web-search-input" placeholder="e.g., 'Secondary Physics 1 Student Textbook'" class="w-full pl-12 pr-4 py-3 rounded-lg bg-[var(--input-bg-color)] border border-[var(--input-border-color)] text-[var(--text-color)] focus:border-[var(--focus-ring-color)] focus:ring-1 focus:ring-[var(--focus-ring-color)] transition-shadow shadow-sm" oninput="filterBooks()">
                    <i data-lucide="search" class="w-5 h-5 text-[var(--text-muted-color)] absolute left-4"></i>
                    <!-- Removed search button as it's now a live filter -->
                </div>
            </div>

            <!-- South Sudan Secondary books Folder -->
            <div class="bg-[var(--card-bg-color)] border border-[var(--border-color)] rounded-xl shadow-sm overflow-hidden">
                <!-- Main Folder Button -->
                <button @click="mainOpen = !mainOpen" class="w-full flex items-center justify-between p-5 text-left transition-colors hover:bg-[var(--active-icon-bg-color)]">
                    <div class="flex items-center space-x-3">
                        <i data-lucide="folder-archive" class="w-6 h-6 text-[var(--text-color)]"></i>
                        <span class="text-2xl font-bold text-[var(--text-color)]">South Sudan Secondary books</span>
                    </div>
                    <i data-lucide="chevron-down" class="w-5 h-5 text-[var(--text-muted-color)] transition-transform" :class="{ 'rotate-180': mainOpen }"></i>
                </button>

                <!-- Main Folder Content (The Senior Folders) -->
                <div x-show="mainOpen" x-transition:enter="transition ease-out duration-300" x-transition:enter-start="opacity-0 -translate-y-2" x-transition:enter-end="opacity-100 translate-y-0" x-transition:leave="transition ease-in duration-200" x-transition:leave-start="opacity-100 translate-y-0" x-transition:leave-end="opacity-0 -translate-y-2" class="p-4 pt-0">
                    
                    <!-- New Professional Description -->
                    <p id="library-description" class="text-base text-[var(--text-muted-color)] px-4 py-3 mb-4 border-b border-[var(--border-color)]">
                        A curated collection of official textbooks for the South Sudan secondary curriculum.
                    </p>

                    <!-- No Results Message (for local search) -->
                    <div id="no-results-message" class="text-center py-8 text-[var(--text-muted-color)]" style="display: none;">
                        <i data-lucide="folder-search" class="w-12 h-12 mx-auto mb-4"></i>
                        <h3 class="text-xl font-semibold text-[var(--text-color)]">No Results Found</h3>
                        <p>No books in the library match your search term.</p>
                    </div>

                    <div class="space-y-4">
                        
                        <!-- Senior One Folder -->
                        <div class="senior-section">
                            <!-- S1 Folder Button -->
                            <button id="s1-folder" @click="openSenior = (openSenior === 's1' ? '' : 's1')" class="w-full flex items-center justify-between p-4 bg-[var(--bg-color)] rounded-lg transition-colors hover:bg-[var(--active-icon-bg-color)]">
                                <div class="flex items-center space-x-2">
                                    <i data-lucide="folder" class="w-5 h-5 text-[var(--text-muted-color)]"></i>
                                    <span class="text-xl font-semibold text-[var(--text-color)]">Senior One</span>
                                </div>
                                <i data-lucide="chevron-down" class="w-5 h-5 text-[var(--text-muted-color)] transition-transform" :class="{ 'rotate-180': openSenior === 's1' }"></i>
                            </button>
                            <!-- S1 Content -->
                            <div x-show="openSenior === 's1' || openSenior === 'all'" x-transition:enter="transition ease-out duration-200" x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100" x-transition:leave="transition ease-in duration-100" x-transition:leave-start="opacity-100" x-transition:leave-end="opacity-0" class="pt-6 px-4">
                                <div id="senior-one-books" class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-x-8 gap-y-12"></div>
                            </div>
                        </div>

                        <!-- Senior Two Folder -->
                        <div class="senior-section">
                            <button id="s2-folder" @click="openSenior = (openSenior === 's2' ? '' : 's2')" class="w-full flex items-center justify-between p-4 bg-[var(--bg-color)] rounded-lg transition-colors hover:bg-[var(--active-icon-bg-color)]">
                                <div class="flex items-center space-x-2">
                                    <i data-lucide="folder" class="w-5 h-5 text-[var(--text-muted-color)]"></i>
                                    <span class="text-xl font-semibold text-[var(--text-color)]">Senior Two</span>
                                </div>
                                <i data-lucide="chevron-down" class="w-5 h-5 text-[var(--text-muted-color)] transition-transform" :class="{ 'rotate-180': openSenior === 's2' }"></i>
                            </button>
                            <div x-show="openSenior === 's2' || openSenior === 'all'" x-transition:enter="transition ease-out duration-200" x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100" x-transition:leave="transition ease-in duration-100" x-transition:leave-start="opacity-100" x-transition:leave-end="opacity-0" class="pt-6 px-4">
                                <div id="senior-two-books" class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-x-8 gap-y-12"></div>
                            </div>
                        </div>

                        <!-- Senior Three Folder -->
                        <div class="senior-section">
                            <button id="s3-folder" @click="openSenior = (openSenior === 's3' ? '' : 's3')" class="w-full flex items-center justify-between p-4 bg-[var(--bg-color)] rounded-lg transition-colors hover:bg-[var(--active-icon-bg-color)]">
                                <div class="flex items-center space-x-2">
                                    <i data-lucide="folder" class="w-5 h-5 text-[var(--text-muted-color)]"></i>
                                    <span class="text-xl font-semibold text-[var(--text-color)]">Senior Three</span>
                                </div>
                                <i data-lucide="chevron-down" class="w-5 h-5 text-[var(--text-muted-color)] transition-transform" :class="{ 'rotate-180': openSenior === 's3' }"></i>
                            </button>
                            <div x-show="openSenior === 's3' || openSenior === 'all'" x-transition:enter="transition ease-out duration-200" x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100" x-transition:leave="transition ease-in duration-100" x-transition:leave-start="opacity-100" x-transition:leave-end="opacity-0" class="pt-6 px-4">
                                <div id="senior-three-books" class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-x-8 gap-y-12"></div>
                            </div>
                        </div>

                        <!-- Senior Four Folder -->
                        <div class="senior-section">
                            <button id="s4-folder" @click="openSenior = (openSenior === 's4' ? '' : 's4')" class="w-full flex items-center justify-between p-4 bg-[var(--bg-color)] rounded-lg transition-colors hover:bg-[var(--active-icon-bg-color)]">
                                <div class="flex items-center space-x-2">
                                    <i data-lucide="folder" class="w-5 h-5 text-[var(--text-muted-color)]"></i>
                                    <span class="text-xl font-semibold text-[var(--text-color)]">Senior Four</span>
                                </div>
                                <i data-lucide="chevron-down" class="w-5 h-5 text-[var(--text-muted-color)] transition-transform" :class="{ 'rotate-180': openSenior === 's4' }"></i>
                            </button>
                            <div x-show="openSenior === 's4' || openSenior === 'all'" x-transition:enter="transition ease-out duration-200" x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100" x-transition:leave="transition ease-in duration-100" x-transition:leave-start="opacity-100" x-transition:leave-end="opacity-0" class="pt-6 px-4">
                                <div id="senior-four-books" class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-x-8 gap-y-12"></div>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
            
        </div>
    </main>

    <!-- Recommendation Modal -->
    <div x-show="showModal" 
         x-cloak
         x-transition:enter="ease-out duration-300"
         x-transition:enter-start="opacity-0"
         x-transition:enter-end="opacity-100"
         x-transition:leave="ease-in duration-200"
         x-transition:leave-start="opacity-100"
         x-transition:leave-end="opacity-0"
         class="fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm p-4">
        
        <div @click.outside="showModal = false" 
             x-show="showModal"
             x-transition:enter="ease-out duration-300"
             x-transition:enter-start="opacity-0 scale-95"
             x-transition:enter-end="opacity-100 scale-100"
             x-transition:leave="ease-in duration-200"
             x-transition:leave-start="opacity-100 scale-100"
             x-transition:leave-end="opacity-0 scale-95"
             class="relative w-full max-w-md bg-[var(--card-bg-color)] rounded-2xl shadow-xl p-6 border border-[var(--border-color)]">
            
            <!-- Modal Header -->
            <div class="flex items-center justify-between pb-3 border-b border-[var(--border-color)]">
                <h3 class="text-lg font-semibold text-[var(--text-color)]">Book Recommendation</h3>
                <button @click="showModal = false" class="p-1 rounded-full text-[var(--text-muted-color)] hover:bg-[var(--active-icon-bg-color)] hover:text-[var(--text-color)] transition-colors">
                    <i data-lucide="x" class="w-5 h-5"></i>
                </button>
            </div>
            
            <!-- Modal Body -->
            <div class="mt-4">
                <p class="text-[var(--text-muted-color)]">
                    If you have any interest in any book you can just tell us. We'll do our best to add it to the library!
                </p>
            </div>
            
            <!-- Modal Footer -->
            <div class="mt-6 flex justify-end">
                <a href="mailto:hc.wisely@gmail.com"
                   target="_blank"
                   @click="showModal = false"
                   class="flex items-center justify-center space-x-2 px-5 py-2.5 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors duration-300 font-semibold text-sm">
                    <!-- Simple Gmail-like icon -->
                    <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24"><path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"/></svg>
                    <span>Send Email via Gmail</span>
                </a>
            </div>
        </div>
    </div>

    <!-- Floating Navigation -->
    <nav class="fixed bottom-4 left-1/2 -translate-x-1/2">
        <div class="flex items-center space-x-2 bg-[var(--card-bg-color)]/80 backdrop-blur-lg border border-[var(--border-color)] rounded-full p-2 shadow-2xl transition-transform duration-300 ease-in-out hover:-translate-y-1">
            <a href="index.html" title="Home" class="p-3 rounded-full text-[var(--text-muted-color)] hover:bg-[var(--active-icon-bg-color)] hover:text-[var(--active-link-color)] transition-colors"><i data-lucide="home" class="w-6 h-6"></i></a>
            <a href="features.html" title="Features" class="p-3 rounded-full text-[var(--text-muted-color)] hover:bg-[var(--active-icon-bg-color)] hover:text-[var(--active-link-color)] transition-colors"><i data-lucide="wand-2" class="w-6 h-6"></i></a>
            <a href="books.html" title="My Library" class="p-3 rounded-full bg-[var(--active-icon-bg-color)] text-[var(--active-link-color)] transition-colors"><i data-lucide="library" class="w-6 h-6"></i></a>
            <a href="ai-notebook.html" title="S Notebook" class="p-3 rounded-full text-[var(--text-muted-color)] hover:bg-[var(--active-icon-bg-color)] hover:text-[var(--active-link-color)] transition-colors"><span class="font-logo w-6 h-6 flex items-center justify-center text-xl leading-none">S</span></a>
            <a href="contact.html" title="Contact" class="p-3 rounded-full text-[var(--text-muted-color)] hover:bg-[var(--active-icon-bg-color)] hover:text-[var(--active-link-color)] transition-colors"><i data-lucide="mail" class="w-6 h-6"></i></a>
            <a href="account-center.html" title="Account" class="p-3 rounded-full text-[var(--text-muted-color)] hover:bg-[var(--active-icon-bg-color)] hover:text-[var(--active-link-color)] transition-colors"><i data-lucide="user-circle-2" class="w-6 h-6"></i></a>
        </div>
    </nav>
    
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            lucide.createIcons();

            const seniorOneLinks = [
                "https://cdc.gov.ss/uploads/subjects/Secondary%20Biology%201%20Student%20Textbook.pdf",
                "https://cdc.gov.ss/uploads/subjects/Secondary%20Chemistry%201%20Student%20Textbook.pdf",
                "https://cdc.gov.ss/uploads/subjects/Secondary%20Citizenship%201%20Student%20Textbook.pdf",
                "https://cdc.gov.ss/uploads/subjects/Secondary%20CRE%201%20Student%20Textbook.pdf",
                "https://cdc.gov.ss/uploads/subjects/Secondary%20English%201%20Student%20Textbook.pdf",
                "https://cdc.gov.ss/uploads/subjects/Secondary%20Geography%201%20Student%20Textbook.pdf",
                "https://cdc.gov.ss/uploads/subjects/Secondary%20History%201%20Student%20Textbook.pdf",
                "https://cdc.gov.ss/uploads/subjects/Secondary%20ICT%201%20Student%20Textbook.pdf",
                "https://cdc.gov.ss/uploads/subjects/Secondary%20Kiswahili%201%20Student%20Textbook.pdf",
                "https://cdc.gov.ss/uploads/subjects/Secondary%20Mathematics%201%20Student%20Textbook.pdf",
                "https://cdc.gov.ss/uploads/subjects/Secondary%20Physics%201%20Student%20Textbook.pdf"
            ];

            const seniorTwoLinks = [
                "https://cdc.gov.ss/uploads/subjects/Secondary%20Biology%202%20Student%20Textbook.pdf",
                "https://cdc.gov.ss/uploads/subjects/Secondary%20Chemistry%202%20Student%20Textbook.pdf",
                "https://cdc.gov.ss/uploads/subjects/Secondary%20Citizenship%202%20Student%20Textbook.pdf",
                "https://cdc.gov.ss/uploads/subjects/Secondary%20CRE%202%20Student%20Textbook.pdf",
                "https://cdc.gov.ss/uploads/subjects/Secondary%20English%202%20Student%20Textbook.pdf",
                "https://cdc.gov.ss/uploads/subjects/Secondary%20Geography%202%20Student%20Textbook.pdf",
                "https://cdc.gov.ss/uploads/subjects/Secondary%20History%202%20Student%20Textbook.pdf",
                "https://cdc.gov.ss/uploads/subjects/Secondary%20ICT%202%20Student%20Textbook.pdf",
                "https://cdc.gov.ss/uploads/subjects/Secondary%20Kiswahili%202%20Student%20Textbook.pdf",
                "https://cdc.gov.ss/uploads/subjects/Secondary%20Mathematics%202%20Student%20Textbook.pdf",
                "https://cdc.gov.ss/uploads/subjects/Secondary%20Physics%202%20Student%20Textbook.pdf"
            ];
            
            const seniorThreeLinks = [
                "https://cdc.gov.ss/uploads/subjects/Secondary%20Biology%203%20Student%20Textbook.pdf",
                "https://cdc.gov.ss/uploads/subjects/Secondary%20Chemistry%203%20Student%20Textbook.pdf",
                "https://cdc.gov.ss/uploads/subjects/Secondary%20Citizenship%203%20Student%20Textbook.pdf",
                "https://cdc.gov.ss/uploads/subjects/Secondary%20CRE%203%20Student%20Textbook.pdf",
                "https://cdc.gov.ss/uploads/subjects/Secondary%20English%203%20Student%20Textbook.pdf",
                "https://cdc.gov.ss/uploads/subjects/Secondary%20Geography%203%20Student%20Textbook.pdf",
                "https://cdc.gov.ss/uploads/subjects/Secondary%20History%203%20Student%20Textbook.pdf",
                "https://cdc.gov.ss/uploads/subjects/Secondary%20ICT%203%20Student%20Textbook.pdf",
                "https://cdc.gov.ss/uploads/subjects/Secondary%20Kiswahili%203%20Student%20Textbook.pdf",
                "https://cdc.gov.ss/uploads/subjects/Secondary%20Mathematics%203%20Student%20Textbook.pdf",
                "https://cgatechnologies.org.uk/sites/default/files/2021-11/OK_Add%20Maths%20S3%20SB%20Cover.pdf"
            ];
            
            const seniorFourLinks = [
                 "https://cdc.gov.ss/uploads/subjects/Secondary%20Additional%20Maths%204%20Student%20Textbook.pdf",
                "https://cdc.gov.ss/uploads/subjects/Secondary%20Biology%204%20Student%20Textbook.pdf",
                "https://cdc.gov.ss/uploads/subjects/Secondary%20Chemistry%204%20Student%20Textbook.pdf",
                "https://cdc.gov.ss/uploads/subjects/Secondary%20Citizenship%204%20Student%20Textbook.pdf",
                "https://cdc.gov.ss/uploads/subjects/Secondary%20CRE%204%20Student%20Textbook.pdf",
                "https://cdc.gov.ss/uploads/subjects/Secondary%20English%204%20Student%20Textbook.pdf",
                "https://cdc.gov.ss/uploads/subjects/Secondary%20Geography%204%20Student%20Textbook.pdf",
                "https://cdc.gov.ss/uploads/subjects/Secondary%20History%204%20Student%20Textbook.pdf",
                "https://cdc.gov.ss/uploads/subjects/Secondary%20ICT%204%20Student%20Textbook.pdf",
                "https://cdc.gov.ss/uploads/subjects/Secondary%20Kiswahili%204%20Student%20Textbook.pdf",
                "https://cdc.gov.ss/uploads/subjects/Secondary%20Mathematics%204%20Student%20Textbook.pdf",
                "https://cdc.gov.ss/uploads/subjects/Secondary%20Physics%204%20Student%20Textbook.pdf"
            ];

            function createBookElement(link) {
                const fileName = decodeURIComponent(link.split('/').pop());
                const parts = fileName.replace('.pdf', '').replace(/%20/g, ' ').split(' ');
                
                let subject = "Unknown";
                let year = "";

                if (parts.includes("Additional") && parts.includes("Maths")) {
                    subject = "Add. Maths";
                } else if (parts.length > 2) {
                     subject = parts[1];
                     if(subject === "CRE") subject = "C.R.E"
                }
                
                year = "S" + parts[2];
                if(fileName.includes("OK_Add")) {
                    subject = "Add. Maths";
                    year = "S3";
                }


                const textColor = (localStorage.getItem('theme') || 'light') === 'light' ? '1f2937' : 'ffffff';
                const bgColor = (localStorage.getItem('theme') || 'light') === 'light' ? 'ffffff' : '111827';
                
                const placeholderUrl = `https://placehold.co/200x300/${bgColor}/${textColor}?text=${subject.replace(' ', '+')}+${year}`;

                return `
                    <a href="${link}" target="_blank" class="text-center group book-item">
                        <img src="${placeholderUrl}" alt="${subject} ${year}" class="rounded-md shadow-lg mb-2 w-full aspect-[2/3] object-cover transition-transform duration-300 group-hover:scale-105 border border-[var(--border-color)]" onerror="this.src='https://placehold.co/200x300/${bgColor}/${textColor}?text=Error'">
                        <h3 class="font-semibold text-[var(--text-color)] mt-2 group-hover:underline">${subject}</h3>
                    </a>
                `;
            }

            document.getElementById('senior-one-books').innerHTML = seniorOneLinks.map(createBookElement).join('');
            document.getElementById('senior-two-books').innerHTML = seniorTwoLinks.map(createBookElement).join('');
            document.getElementById('senior-three-books').innerHTML = seniorThreeLinks.map(createBookElement).join('');
            document.getElementById('senior-four-books').innerHTML = seniorFourLinks.map(createBookElement).join('');

            // Remove web search functionality
            // const webSearchForm = document.getElementById('web-search-form'); ...
        });

        // New local book filtering function
        function filterBooks() {
            const searchTerm = document.getElementById('web-search-input').value.toLowerCase();
            const seniorSections = document.querySelectorAll('.senior-section');
            const noResultsMessage = document.getElementById('no-results-message');
            const libraryDescription = document.getElementById('library-description');
            const alpineData = document.body._x_dataStack[0];
            let totalResultsFound = 0;

            if (searchTerm === '') {
                // Reset everything to default
                seniorSections.forEach(section => {
                    section.style.display = 'block';
                    section.querySelectorAll('.book-item').forEach(book => {
                        book.style.display = 'block';
                    });
                });
                if (libraryDescription) libraryDescription.style.display = 'block';
                if (noResultsMessage) noResultsMessage.style.display = 'none';
                alpineData.mainOpen = true; // Keep main folder open
                alpineData.openSenior = ''; // Close all senior folders
                return;
            }

            // --- We have a search term ---
            if (libraryDescription) libraryDescription.style.display = 'none'; // Hide description
            alpineData.mainOpen = true; // Ensure main folder is open
            alpineData.openSenior = 'all'; // Custom value to force all senior folders open

            seniorSections.forEach(section => {
                let sectionResultsFound = 0;
                const books = section.querySelectorAll('.book-item');
                
                books.forEach(book => {
                    const titleElement = book.querySelector('h3');
                    if (titleElement) {
                        const title = titleElement.textContent.toLowerCase();
                        if (title.includes(searchTerm)) {
                            book.style.display = 'block';
                            sectionResultsFound++;
                        } else {
                            book.style.display = 'none';
                        }
                    }
                });

                // Show or hide the entire section
                if (sectionResultsFound > 0) {
                    section.style.display = 'block'; 
                    totalResultsFound += sectionResultsFound;
                } else {
                    section.style.display = 'none'; 
                }
            });

            // Show 'no results' message if needed
            if (noResultsMessage) {
                noResultsMessage.style.display = totalResultsFound === 0 ? 'block' : 'none';
            }
        }
    </script>
</body>
</html>

